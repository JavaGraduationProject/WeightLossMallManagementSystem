var W=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var j=(e,t,r)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,G=(e,t)=>{for(var r in t||(t={}))Z.call(t,r)&&j(e,r,t[r]);if(L)for(var r of L(t))x.call(t,r)&&j(e,r,t[r]);return e},A=(e,t)=>X(e,Y(t));import{g as M,D as m,m as c,o as q,j as N,w as u,n as a,q as O,A as ee,F as le,u as ae,i as te,L as oe,x as U,k as i,ac as ne,aj as se,K as re,ai as de,J as I,y as B,ab as ue}from"./vendor.6c10456e.js";import{_ as ie,p as h,d as pe,r as me,o as ce}from"./index.e298dbcb.js";import{o as fe,p as be,r as ve,s as Q,q as _e,t as ge}from"./user.81f71bdb.js";import{_ as ye,b as $e,a as E,c as Ve}from"./QueryItem.08153dac.js";import{_ as he}from"./ListMove.8a454c07.js";import{_ as Ie}from"./DialogForm.42204124.js";const Be=M({components:{DialogForm:Ie},props:{modelValue:{type:Boolean,required:!0},beanId:{required:!0},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(){const e=m();return{queryGroup:fe,createGroup:be,updateGroup:ve,deleteGroup:Q,focus:e}}});function qe(e,t,r,_,w,$){const f=c("el-input"),b=c("el-form-item"),g=c("el-option"),V=c("el-select"),C=c("dialog-form");return q(),N(C,{name:e.$t("menu.user.group"),queryBean:e.queryGroup,createBean:e.createGroup,updateBean:e.updateGroup,deleteBean:e.deleteGroup,beanId:e.beanId,beanIds:e.beanIds,focus:e.focus,initValues:()=>({type:2}),toValues:n=>G({},n),disableDelete:n=>n.id<=10,perms:"group","model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=n=>e.$emit("update:modelValue",n)),onFinished:t[1]||(t[1]=n=>e.$emit("finished"))},{default:u(({values:n})=>[a(b,{prop:"name",label:e.$t("group.name"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:u(()=>[a(f,{modelValue:n.name,"onUpdate:modelValue":s=>n.name=s,ref:"focus",maxlength:"50"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"]),a(b,{prop:"description",label:e.$t("group.description")},{default:u(()=>[a(f,{modelValue:n.description,"onUpdate:modelValue":s=>n.description=s,maxlength:"255"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),a(b,{prop:"type",label:e.$t("group.type"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:u(()=>[a(V,{modelValue:n.type,"onUpdate:modelValue":s=>n.type=s,disabled:n.type===1},{default:u(()=>[(q(),O(le,null,ee([1,2],s=>a(g,{key:s,disabled:s===1,label:e.$t(`group.type.${s}`),value:s},null,8,["disabled","label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","rules"])]),_:1},8,["name","queryBean","createBean","updateBean","deleteBean","beanId","beanIds","focus","initValues","toValues","disableDelete","model-value"])}var we=ie(Be,[["render",qe]]);const Ce={class:"mb-3"},De={class:"app-block mt-3"},Ae=M({setup(e){const{t}=ae(),r=m({}),_=m(),w=m(),$=m([]),f=m([]),b=m(!1),g=m(!1),V=m(),C=te(()=>$.value.map(l=>l.id)),n=m(!1),s=async()=>{b.value=!0;try{$.value=await _e(A(G({},pe(r.value)),{Q_OrderBy:_.value})),n.value=Object.values(r.value).filter(l=>l!==void 0&&l!=="").length>0||_.value!==void 0}finally{b.value=!1}};oe(s);const R=({column:l,prop:o,order:p})=>{var v;o?_.value=((v=l.sortBy)!=null?v:o)+(p==="descending"?"_desc":""):_.value=void 0,s()},z=()=>s(),P=()=>{w.value.clearSort(),me(r.value),_.value=void 0,s()},J=()=>{V.value=void 0,g.value=!0},S=l=>{V.value=l,g.value=!0},D=l=>l>10,F=async l=>{const o=l.filter(p=>D(p));o.length>0&&(await Q(o),s(),re.success(t("success")))},K=async(l,o)=>{const p=ce(l,$.value,o);await ge(p.map(v=>v.id))};return(l,o)=>{const p=c("el-button"),v=c("el-popconfirm"),y=c("el-table-column"),T=c("el-table"),H=de("loading");return q(),O("div",null,[U("div",Ce,[a(i(ye),{params:r.value,onSearch:z,onReset:P},{default:u(()=>[a(i(E),{label:l.$t("group.name"),name:"Q_Contains_name"},null,8,["label"]),a(i(E),{label:l.$t("group.description"),name:"Q_Contains_description"},null,8,["label"])]),_:1},8,["params"])]),U("div",null,[a(p,{type:"primary",disabled:i(h)("group:create"),icon:i(ne),onClick:J},{default:u(()=>[I(B(l.$t("add")),1)]),_:1},8,["disabled","icon"]),a(v,{title:l.$t("confirmDelete"),onConfirm:o[0]||(o[0]=d=>F(f.value.map(k=>k.id)))},{reference:u(()=>[a(p,{disabled:f.value.filter(d=>D(d.id)).length<=0||i(h)("group:delete"),icon:i(ue)},{default:u(()=>[I(B(l.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),a(he,{class:"ml-2",disabled:f.value.length<=0||n.value||i(h)("org:update"),onMove:o[1]||(o[1]=d=>K(f.value,d))},null,8,["disabled"]),a(i($e),{name:"group",class:"ml-2"})]),U("div",De,[se((q(),N(T,{ref_key:"table",ref:w,data:$.value,onSelectionChange:o[2]||(o[2]=d=>f.value=d),onRowDblclick:o[3]||(o[3]=d=>S(d.id)),onSortChange:R},{default:u(()=>[a(i(Ve),{name:"group"},{default:u(()=>[a(y,{type:"selection",width:"50"}),a(y,{property:"id",label:"ID",width:"64",sortable:"custom"}),a(y,{property:"name",label:l.$t("group.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),a(y,{property:"description",label:l.$t("group.description"),"min-width":"150",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),a(y,{property:"type",label:l.$t("group.type"),sortable:"custom","show-overflow-tooltip":"",formatter:d=>l.$t(`group.type.${d.type}`)},null,8,["label","formatter"]),a(y,{label:l.$t("table.action")},{default:u(({row:d})=>[a(p,{type:"text",disabled:i(h)("group:update"),onClick:k=>S(d.id),size:"small"},{default:u(()=>[I(B(l.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),a(v,{title:l.$t("confirmDelete"),onConfirm:k=>F([d.id])},{reference:u(()=>[a(p,{type:"text",disabled:!D(d.id)||i(h)("group:delete"),size:"small"},{default:u(()=>[I(B(l.$t("delete")),1)]),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[H,b.value]])]),a(we,{modelValue:g.value,"onUpdate:modelValue":o[4]||(o[4]=d=>g.value=d),beanId:V.value,beanIds:i(C),onFinished:s},null,8,["modelValue","beanId","beanIds"])])}}});export{Ae as default};
